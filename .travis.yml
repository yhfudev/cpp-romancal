# this is a workaround because some OpenCL headers cause problems with older gcc compilers (undefined macro: _WIN32)
before_install:
 - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then sed -i "" 's/if _WIN32/if defined (_WIN32)/' include/romancal.h; fi
 - if [[ "$TRAVIS_OS_NAME" != "osx" ]]; then sed -i    's/if _WIN32/if defined (_WIN32)/' include/romancal.h; fi
os:
  - linux
  - osx
language: c
compiler:
  - clang
  - gcc
install:
  # Install 3rd unit test library -- check
  - wget https://github.com/libcheck/check/releases/download/0.11.0/check-0.11.0.tar.gz
  - tar -xf check-0.11.0.tar.gz -C ${TRAVIS_BUILD_DIR}
  # Install 3rd unit test library -- catch.hpp
  - wget -O ${TRAVIS_BUILD_DIR}/catch.hpp https://github.com/philsquared/Catch/releases/download/v1.8.1/catch.hpp
script:
  - (cd ${TRAVIS_BUILD_DIR}/check-0.11.0/ && make clean ; ./configure --enable-shared=no --enable-static=yes; make clean; make; cd -)
  - ./autogen.sh && ./configure --enable-static --disable-shared --enable-debug --with-libcheck=${TRAVIS_BUILD_DIR}/check-0.11.0/ CPPFLAGS=-I${TRAVIS_BUILD_DIR}/include2/ && make check
  - ./autogen.sh && ./configure --enable-static --disable-shared --enable-debug CPPFLAGS=-I${TRAVIS_BUILD_DIR} && make check
